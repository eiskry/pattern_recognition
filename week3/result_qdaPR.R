source("qdaPR")

h1<-c(190,189,188,188,187)
w1<-c(90,87,89,87,89)
h2<-c(186,185,185,184,183)
w2<-c(85,84,83,84,83)
class<-c(rep(1,5),rep(2,5))
mh1<-mean(h1)
mw1<-mean(w1)
m1<-c(mh1, mw1)
mh2<-mean(h2)
mw2<-mean(w2)
m2<-c(mh2, mw2)
p1<-cbind(h1,w1)
p2<-cbind(h2,w2)
p<-rbind(p1,p2)
# plot(p,xlim=c(182,192),ykim=c(82,92),xlab="Height",ylab="Weight",type="n")
# text(p,labels=as.character(class))

cov1<-solve(cov(p1))
cov2<-solve(cov(p2))
x<-seq(182,192,0.1)
y<-seq(82,92,0.1)
XY<-matrix(c(rep(x,length(y)),rep(y,each=length(x))),,2)
dist1<-binorm(XY,m1,det(cov(p1)),cov1)
dist2<-binorm(XY,m2,det(cov(p2)),cov2)
contour(x,y,matrix(dist1,length(x),length(y)),nlevels=20,add=T,lty=3)
contour(x,y,matrix(dist2,length(x),length(y)),nlevels=20,add=T,lty=3)

S<-cov1-cov2
c<-m2%*%cov2 - m1%*%cov1
F<-t(m1)%*%cov1%*%m1 - t(m2)%*%cov2%*%m2 + log(det(cov(p1))/det(cov(p2)))
res<-qdaPR(XY,S,c,F)
contour(x,y,matrix(res,length(x),length(y)),levels=0.0,add=T,lty=3)